#+TITLE: Slice Rush Pizza - Yet Another 3Factor App Approach
#+AUTHOR: Jacob Duijzer
#+STARTUP: inlineimages
* Introduction
* Information Flow

[[file:docs/assets/information-flow.png]]t

#+BEGIN_SRC plantuml :file docs/assets/information-flow.png
@startuml
	participant "Hungry customer" as customer
	queue "Azure Service Bus" as queue
  entity "Order Service" as orderService
	entity "Bakery" as bakery
  entity "Delivery" as delivery
  entity "Customer Service" as customerService
  entity "Management Dashboard" as managementDashboard

	customer -> queue : Ordering Pizza
  orderService <- queue : New pizza order
  managementDashboard <- queue : New pizza order
  orderService -> customer : Payment request
  customer -> queue : Order payment details
  managementDashboard <- queue : Order payment details
  orderService <- queue : Order payment details
  orderService -> queue : Order ready for preparation
  bakery <- queue : Order ready for preparation
  bakery -> queue : Order ready for delivery
  delivery <- queue : Order ready for delivery
  delivery -> queue : Order on the road
  customer <- queue : Order on the road
  delivery -> queue : Order delivered
  orderService <- queue : Order delivered
  managementDashboard <- queue : Order delivered
  customer -> queue : Order feedback
  customerService <- queue : Order feedback
  managementDashboard <- queue : Order feedback
	
@enduml
#+END_SRC

#+RESULTS:
[[file:docs/assets/information-flow.png]]

** Azure Infra Architecture

[[file:docs/assets/azure-infra-architecture.png]]

#+BEGIN_SRC plantuml :file docs/assets/azure-infra-architecture.png
!define AzurePuml https://raw.githubusercontent.com/plantuml-stdlib/Azure-PlantUML/release/2-2/dist
!includeurl AzurePuml/AzureCommon.puml
!includeurl AzurePuml/Compute/AzureFunction.puml
!includeurl AzurePuml/Integration/AzureServiceBus.puml
!includeurl AzurePuml/Integration/AzureServiceBusTopic.puml

''actor "Person" as personAlias
AzureFunction(functionAlias, "Label", "Technology", "Optional Description")
AzureFunction(functionAlias2, "Label", "Technology", "Optional Description")
AzureServiceBus(azureServiceBus, "sbnssrp", "Technology", "Optional Description")
AzureServiceBusTopic(newOrders, "topic-new-order", "Techonology", "Optional Description")
AzureServiceBusTopic(newPayments, "topic-new-payment", "Techonology", "Optional Description")

azureServiceBus --> newOrders
azureServiceBus --> newPayments
newOrders --> functionAlias
functionAlias --> newPayments
newPayments --> functionAlias2

#+END_SRC 

#+RESULTS:
[[file:docs/assets/azure-infra-architecture.png]]

* Resources

- [[https://learn.microsoft.com/en-us/training/modules/test-bicep-code-using-github-actions/7-exercise-add-preview-job-workflow][Bicep + Github + Review]]

